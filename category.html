<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Buy Milk, Bread & Eggs Online - Daily FarmFresh</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <header></header>

    <div class="filter-row lg:hidden">
        <button class="filter-chip active">Sort <span class="text-muted">▼</span></button>
        <button class="filter-chip dark">Brand <span class="text-white">▼</span></button>
        <button class="filter-chip">Price</button>
        <button class="filter-chip">Pack Size</button>
    </div>

    <div class="cat-layout">

        <aside class="sidebar-nav hidden lg:block">
            <div class="sidebar-header">Dairy, Bread & Eggs</div>
            <div class="sidebar-item active">
                <div class="sidebar-thumb"><img src="https://cdn.grofers.com/app/images/category/cms_images/icon/922_1643384380004.png" alt="Milk"></div>
                <span class="text-sm font-medium">Milk</span>
            </div>
            <div class="sidebar-item">
                <div class="sidebar-thumb"><img src="https://cdn.grofers.com/app/images/category/cms_images/icon/953_1657599742631.png" alt="Bread"></div>
                <span class="text-sm font-medium">Bread & Pav</span>
            </div>
            <div class="sidebar-item">
                <div class="sidebar-thumb"><img src="https://cdn.grofers.com/app/images/category/cms_images/icon/954_1680251634382.png" alt="Eggs"></div>
                <span class="text-sm font-medium">Eggs</span>
            </div>
            <div class="sidebar-item">
                <div class="sidebar-thumb"><img src="https://cdn.grofers.com/app/images/category/cms_images/icon/923_1643384369257.png" alt="Paneer"></div>
                <span class="text-sm font-medium">Paneer & Tofu</span>
            </div>
            <div class="sidebar-item">
                <div class="sidebar-thumb"><img src="https://cdn.grofers.com/app/images/category/cms_images/icon/123_1643384414434.png" alt="Curd"></div>
                <span class="text-sm font-medium">Curd & Yogurt</span>
            </div>
            <div class="sidebar-item">
                <div class="sidebar-thumb"><img src="https://cdn.grofers.com/app/images/category/cms_images/icon/1089_1643384401831.png" alt="Butter"></div>
                <span class="text-sm font-medium">Butter & More</span>
            </div>
        </aside>

        <main class="cat-main">
            
            <div class="hidden lg:block">
                <div class="breadcrumb">
                    <a href="index.html">Home</a> <span>/</span> 
                    <a href="#">Dairy, Bread & Eggs</a> <span>/</span> 
                    <span class="text-dark">Milk</span>
                </div>
                <div class="cat-header-desktop">
                    <h1 class="text-xl font-bold">Buy Milk Online</h1>
                    <div class="text-xs text-muted">Sort by <span class="font-bold text-success" style="color:#0c831f">Relevance</span></div>
                </div>
            </div>

            <div class="lg:hidden mb-4 mt-2">
                <h1 class="text-lg font-bold">Milk</h1>
                <p class="text-xs text-muted">24 products</p>
            </div>

            <div class="cat-product-grid" id="product-grid">
                </div>

        </main>
    </div>

    <footer class="hidden lg:block"></footer>

    <nav class="bottom-nav lg:hidden">
        <a href="index.html" class="nav-item">
            <span class="nav-icon">🏠</span>
            <span>Home</span>
        </a>
        <a href="#" class="nav-item active">
            <span class="nav-icon">🔍</span>
            <span>Search</span>
        </a>
        <a href="cart.html" class="nav-item relative">
            <span class="nav-icon">🛒</span>
            <span>Cart</span>
            <span id="nav-badge" class="hidden" style="position: absolute; top: -5px; right: 20px; background: var(--primary); color: white; font-size: 0.6rem; padding: 1px 5px; border-radius: 10px;">0</span>
        </a>
        <a href="orders.html" class="nav-item">
            <span class="nav-icon">🛍️</span>
            <span>Orders</span>
        </a>
    </nav>

    <script type="module">
        import { products } from './js/data.js';

        const grid = document.getElementById('product-grid');

        // Logic: Filter for "Milk" related items
        // In a real app, we would read the URL param ?cat=...
        // Here we simulate the "Milk" category page
        let displayProducts = products.filter(p => 
            (p.subcategory && p.subcategory === 'Milk') || 
            p.name.toLowerCase().includes('milk')
        );

        // Fallback if data is scarce, just show dairy
        if (displayProducts.length < 3) {
            displayProducts = products.filter(p => p.category === 'dairy-bread');
        }

        // 1. Render Function (Reusing FarmFresh Card Style)
        function renderProductCard(prod) {
            const isOutOfStock = prod.outOfStock;
            // Generate a random delivery time for realism if missing
            const time = prod.deliveryTime || "12 MINS";
            
            return `
                <div class="product-card ${isOutOfStock ? 'opacity-50 pointer-events-none' : ''}">
                    <div class="product-img-wrapper">
                        <img src="${prod.image}" alt="${prod.name}" class="product-img">
                        ${prod.isVeg !== false ? '<div class="veg-icon"></div>' : ''}
                        ${!isOutOfStock ? `<div class="badge-time"><span>⏱</span> ${time}</div>` : ''}
                    </div>
                    
                    <h3 class="product-title" title="${prod.name}">${prod.name}</h3>
                    <div class="product-weight">${prod.weight || prod.unit || '500 g'}</div>
                    
                    <div class="product-footer">
                        <div class="flex flex-col">
                            <span class="price-current">₹${prod.price}</span>
                            ${prod.mrp && prod.mrp > prod.price ? `<span class="price-mrp">₹${prod.mrp}</span>` : ''}
                        </div>
                        
                        ${isOutOfStock 
                            ? '<button class="btn-add-blinkit" style="border-color:#ccc; color:#ccc;" disabled>OOS</button>' 
                            : `<button class="btn-add-blinkit add-to-cart-btn" data-id="${prod.id}">ADD</button>`
                        }
                    </div>
                    ${isOutOfStock ? '<div style="position:absolute; top:40%; left:50%; transform:translate(-50%, -50%); background:white; padding:4px 8px; border-radius:4px; font-weight:bold; font-size:0.7rem; box-shadow:0 2px 5px rgba(0,0,0,0.1);">Out of Stock</div>' : ''}
                </div>
            `;
        }

        // 2. Inject
        if(grid) {
            grid.innerHTML = displayProducts.map(renderProductCard).join('');
        }
    </script>
    <script type="module" src="js/main.js"></script>
</body>
</html>
